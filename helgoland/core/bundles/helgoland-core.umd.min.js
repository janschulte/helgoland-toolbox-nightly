!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common/http"),require("rxjs"),require("rxjs/operator/map"),require("@angular/common"),require("@ngx-translate/core"),require("moment"),require("class-transformer"),require("rxjs/add/operator/map"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@helgoland/core",["exports","@angular/core","@angular/common/http","rxjs","rxjs/operator/map","@angular/common","@ngx-translate/core","moment","class-transformer","rxjs/add/operator/map","rxjs/operators"],e):e((t.helgoland=t.helgoland||{},t.helgoland.core={}),t.ng.core,t.ng.common.http,t.rxjs,t.rxjs["operator/map"],t.ng.common,null,null,null,t.rxjs["add/operator/map"],t.rxjs.operators)}(this,function(t,s,a,l,e,i,r,f,o,n,d){"use strict";f=f&&f.hasOwnProperty("default")?f["default"]:f;var u=function(){function t(){}return t.prototype.getColor=function(){return this.getRandomColor()},t.prototype.convertHexToRGBA=function(t,e){return t=t.replace("#",""),"rgba("+parseInt(t.substring(0,2),16)+","+parseInt(t.substring(2,4),16)+","+parseInt(t.substring(4,6),16)+","+e/100+")"},t.prototype.getRandomColor=function(){for(var t="#",e=0;e<6;e++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t},t.decorators=[{type:s.Injectable}],t}(),c={V1:0,V2:1};c[c.V1]="V1",c[c.V2]="V2";var p=function(){function t(t){this.http=t,this.cache=new Map}return t.prototype.getApiVersion=function(n){var a=this;return new l.Observable(function(r){a.cache.has(n)?a.confirmVersion(r,a.cache.get(n)):a.http.get(n).subscribe(function(t){var e=c.V1;t.forEach(function(t){"platforms"===t.id&&(e=c.V2)}),a.cache.set(n,e),a.confirmVersion(r,e)})})},t.prototype.confirmVersion=function(t,e){t.next(e),t.complete()},t.decorators=[{type:s.Injectable}],t.ctorParameters=function(){return[{type:a.HttpClient}]},t}(),h=function(){function t(){}return t.prototype.getMatchingInterval=function(r,t){if(r&&t)return t.find(function(t){var e=t.upper?parseFloat(t.upper):Number.MAX_VALUE;if((t.lower?parseFloat(t.lower):Number.MIN_VALUE)<=r&&r<e)return!0})},t.decorators=[{type:s.Injectable}],t.ctorParameters=function(){return[]},t}(),m=function(){function t(){}return t.prototype.generateInternalId=function(t){t.internalId=t.url+"__"+t.id},t.prototype.resolveInternalId=function(t){var e=t.split("__");if(2===e.length)return{url:e[0],id:e[1]};console.error("InternalID "+t+" is not resolvable")},t.decorators=[{type:s.Injectable}],t}(),y=function(){function t(){this.localStorageEnabled=!1,"undefined"!=typeof Storage&&(this.localStorageEnabled=!0)}return t.prototype.save=function(t,e){return!!this.localStorageEnabled&&(localStorage.setItem(t,JSON.stringify(e)),!0)},t.prototype.load=function(t){if(this.localStorageEnabled){var e=localStorage.getItem(t);return e?JSON.parse(e):null}},t.prototype.loadArray=function(t){if(this.localStorageEnabled){var e=localStorage.getItem(t);return e?JSON.parse(e):null}},t.prototype.loadTextual=function(t){if(this.localStorageEnabled){var e=localStorage.getItem(t);if(e)return e}return null},t.decorators=[{type:s.Injectable}],t.ctorParameters=function(){return[]},t}(),g="helgoland-notifier",v=function(){function t(){if(!document.getElementById(g)){var t=document.createElement("div");t.id=g,t.className="hide";var e=document.createTextNode("");t.appendChild(e),document.body.appendChild(t)}}return t.prototype.notify=function(t){clearTimeout(this.notifierTimeout);var e=document.getElementById(g);e.innerHTML=t,e.className=e.className.replace("hide","show"),this.notifierTimeout=setTimeout(function(){e.className=e.className.replace("show","hide")},3e3)},t.decorators=[{type:s.Injectable}],t.ctorParameters=function(){return[]},t}(),I=function(){function t(t){this.translate=t}return t.prototype.transform=function(t,e){void 0===e&&(e="mediumDate");var r=new i.DatePipe(this.translate.currentLang||"en");try{return r.transform(t,e)}catch(n){return console.error(n),new i.DatePipe("en").transform(t,e)}},t.decorators=[{type:s.Pipe,args:[{name:"dateI18n",pure:!1}]}],t.ctorParameters=function(){return[{type:r.TranslateService}]},t}(),O=function(t,e){return(O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function D(t,e){function r(){this.constructor=t}O(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var T=function(){},b=function(n){function t(t,e){var r=n.call(this)||this;return r.from=t,r.to=e||t,r}return D(t,n),t}(T),R=function(n){function t(t,e){var r=n.call(this)||this;return r.timestamp=t,r.bufferInterval=e,r}return D(t,n),t}(T),S={LASTHOUR:"last_hour",TODAY:"today",YESTERDAY:"yesterday",TODAY_YESTERDAY:"today_yesterday",CURRENT_WEEK:"current_week",LAST_WEEK:"last_week",CURRENT_MONTH:"current_month",LAST_MONTH:"last_month",CURRENT_YEAR:"current_year",LAST_YEAR:"last_year"},x=function(){function t(){this.intervals=new Map,this.intervals.set(S.LASTHOUR,function(){var t=1e3*f().subtract(1,"hours").unix(),e=1e3*f().unix();return new b(t,e)}),this.intervals.set(S.TODAY,function(){var t=1e3*f().startOf("day").unix(),e=1e3*f().endOf("day").unix();return new b(t,e)}),this.intervals.set(S.YESTERDAY,function(){var t=1e3*f().subtract(1,"days").startOf("day").unix(),e=1e3*f().subtract(1,"days").endOf("day").unix();return new b(t,e)}),this.intervals.set(S.TODAY_YESTERDAY,function(){var t=1e3*f().subtract(1,"days").startOf("day").unix(),e=1e3*f().endOf("day").unix();return new b(t,e)}),this.intervals.set(S.CURRENT_WEEK,function(){var t=1e3*f().startOf("isoWeek").unix(),e=1e3*f().endOf("isoWeek").unix();return new b(t,e)}),this.intervals.set(S.LAST_WEEK,function(){var t=1e3*f().subtract(1,"weeks").startOf("isoWeek").unix(),e=1e3*f().subtract(1,"weeks").endOf("isoWeek").unix();return new b(t,e)}),this.intervals.set(S.CURRENT_MONTH,function(){var t=1e3*f().startOf("month").unix(),e=1e3*f().endOf("month").unix();return new b(t,e)}),this.intervals.set(S.LAST_MONTH,function(){var t=1e3*f().subtract(1,"months").startOf("month").unix(),e=1e3*f().subtract(1,"months").endOf("month").unix();return new b(t,e)}),this.intervals.set(S.CURRENT_YEAR,function(){var t=1e3*f().startOf("year").unix(),e=1e3*f().endOf("year").unix();return new b(t,e)}),this.intervals.set(S.LAST_YEAR,function(){var t=1e3*f().subtract(1,"years").startOf("year").unix(),e=1e3*f().subtract(1,"years").endOf("year").unix();return new b(t,e)})}return t.prototype.getInterval=function(t){if(this.intervals.has(t))return this.intervals.get(t)()},t.decorators=[{type:s.Injectable}],t.ctorParameters=function(){return[]},t}(),A=function(){function t(t){this.localStorage=t}return t.prototype.centerTimespan=function(t,e){var r=this.getDuration(t).asMilliseconds()/2,n=1e3*f(e).subtract(r).unix(),a=1e3*f(e).add(r).unix();return new b(n,a)},t.prototype.stepBack=function(t){var e=this.getDuration(t),r=1e3*f(t.from).subtract(e).unix(),n=1e3*f(t.to).subtract(e).unix();return new b(r,n)},t.prototype.stepForward=function(t){var e=this.getDuration(t),r=1e3*f(t.from).add(e).unix(),n=1e3*f(t.to).add(e).unix();return new b(r,n)},t.prototype.overlaps=function(t,e,r){var n=this.createTimespanOfInterval(t);return n.from<=r&&n.to>=e},t.prototype.createTimespanOfInterval=function(t){if(t instanceof b)return t;if(t instanceof R){var e=f.duration(t.bufferInterval/2),r=1e3*f(t.timestamp).subtract(e).unix(),n=1e3*f(t.timestamp).add(e).unix();return new b(r,n)}console.error("Wrong time interval!")},t.prototype.getBufferedTimespan=function(t,e){var r=this.getDuration(t).asMilliseconds(),n=1e3*f(t.from).subtract(r*e).unix(),a=1e3*f(t.to).add(r*e).unix();return new b(n,a)},t.prototype.saveTimespan=function(t,e){this.localStorage.save(t,e)},t.prototype.loadTimespan=function(t){var e=this.localStorage.load(t);return e?o.plainToClass(b,e):null},t.prototype.initTimespan=function(){var t=new Date,e=1e3*f(t).startOf("day").unix(),r=1e3*f(t).endOf("day").unix();return new b(e,r)},t.prototype.getDuration=function(t){var e=f(t.from),r=f(t.to);return f.duration(r.diff(e))},t.decorators=[{type:s.Injectable}],t.ctorParameters=function(){return[{type:y}]},t}(),E=function(){function t(){}return t.decorators=[{type:s.NgModule,args:[{declarations:[I],imports:[a.HttpClientModule],exports:[I],providers:[u,p,x,m,y,v,h,A]}]}],t}(),q=function(){function t(){}return t.prototype.createRequestUrl=function(t,e,r){var n=t+e;return r&&(n+="/"+r),n},t.prototype.createRequestTimespan=function(t){return encodeURI(f(t.from).format()+"/"+f(t.to).format())},t.prototype.createBasicAuthHeader=function(t){var e=new a.HttpHeaders;return t?e.set("Authorization",t):e},t}(),w=function(){function t(){this.datasetIds=[],this.datasetOptions=new Map}return t.prototype.addDataset=function(t,e){if(this.datasetIds.indexOf(t)<0)this.datasetIds.push(t),e?this.datasetOptions.set(t,e):this.datasetOptions.set(t,this.createStyles(t)),this.saveState();else if(e instanceof Array){var r=this.datasetOptions.get(t);e.forEach(function(t){return r.push(t)}),this.saveState()}},t.prototype.removeAllDatasets=function(){this.datasetIds.length=0,this.datasetOptions.clear(),this.saveState()},t.prototype.removeDataset=function(t){var e=this.datasetIds.indexOf(t);-1<e&&(this.datasetIds.splice(e,1),this.datasetOptions["delete"](t)),this.saveState()},t.prototype.hasDatasets=function(){return 0<this.datasetIds.length},t.prototype.updateDatasetOptions=function(t,e){this.datasetOptions.set(e,t),this.saveState()},t}(),C=function(r){function t(t){var e=r.call(this)||this;return e.api=t,e}return D(t,r),t.prototype.addDataset=function(e,t){var r=this;t?(this.datasetIds.push(e),this.datasetOptions.set(e,t)):this.datasetIds.indexOf(e)<0&&this.api.getSingleTimeseriesByInternalId(e).subscribe(function(t){return r.addLoadedDataset(t)},function(t){r.api.getDatasetByInternalId(e).subscribe(function(t){return r.addLoadedDataset(t)})})},t.prototype.addLoadedDataset=function(t){this.datasetIds.push(t.internalId),this.datasetOptions.set(t.internalId,this.createOptionsOfRenderingHints(t))},t.prototype.createOptionsOfRenderingHints=function(t){var e=this.createStyles(t.internalId);if(t.renderingHints)switch(t.renderingHints.properties&&t.renderingHints.properties.color&&(e.color=t.renderingHints.properties.color),t.renderingHints.chartType){case"line":this.handleLineRenderingHints(t.renderingHints,e);break;case"bar":this.handleBarRenderingHints(t.renderingHints,e)}return e},t.prototype.handleLineRenderingHints=function(t,e){t.properties.width&&(e.lineWidth=Math.round(parseFloat(t.properties.width)))},t.prototype.handleBarRenderingHints=function(t,e){t.properties.width&&(e.lineWidth=Math.round(parseFloat(t.properties.width)))},t}(w),P=function(){function t(){}return t.prototype.encodeKey=function(t){return encodeURIComponent(t)},t.prototype.encodeValue=function(t){return encodeURIComponent(t)},t.prototype.decodeKey=function(t){return t},t.prototype.decodeValue=function(t){return t},t}(),U=function(n){function t(t,e){var r=n.call(this)||this;return r.httpService=t,r.translate=e,r}return D(t,n),t.prototype.requestApi=function(t,e,r){return void 0===e&&(e={}),void 0===r&&(r={}),this.httpService.client(r).get(t,{params:this.prepareParams(e),headers:this.createBasicAuthHeader(r.basicAuthToken)})},t.prototype.prepareParams=function(e){this.translate&&this.translate.currentLang&&(e.locale=this.translate.currentLang);var r=new a.HttpParams({encoder:new P});return Object.getOwnPropertyNames(e).forEach(function(t){return r=r.set(t,e[t])}),r},t}(q),H=function(){},_=function(){},L=function(){},j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return D(e,t),e}(H),N=function(){},V=function(){this.hasData=!1},M=function(){},k=new s.InjectionToken("HTTP_SERVICE_INTERCEPTORS"),B=function(){function t(r,t){this.httpHandler=r;var e={handle:function(t,e){return r.handle(t)}};t&&(e=t.reduceRight(function(r,n){return{handle:function(t,e){return n.intercept(t,e,r)}}},e)),this.handler=e}return t.prototype.client=function(e){var r=this;return void 0===e&&(e={}),new a.HttpClient({handle:function(t){return r.handler.handle(t,e)}})},t.decorators=[{type:s.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[{type:a.HttpHandler},{type:undefined,decorators:[{type:s.Optional},{type:s.Inject,args:[k]}]}]},t.ngInjectableDef=s.defineInjectable({factory:function(){return new t(s.inject(a.HttpHandler),s.inject(k,8))},token:t,providedIn:"root"}),t}(),F=function(a){function t(t,e,r){var n=a.call(this,t,r)||this;return n.httpservice=t,n.internalDatasetId=e,n.translate=r,n}return D(t,a),t.prototype.getServices=function(e,t,r){var n=this.createRequestUrl(e,"services");return t?t.expanded=!0:t={expanded:!0},this.requestApi(n,t,r).pipe(d.map(function(t){return t.forEach(function(t){return t.apiUrl=e}),t}))},t.prototype.getService=function(t,e,r,n){var a=this.createRequestUrl(e,"services",t);return this.requestApi(a,r,n).pipe(d.map(function(t){return t.apiUrl=e,t}))},t.prototype.getStations=function(t,e,r){var n=this.createRequestUrl(t,"stations");return this.requestApi(n,e,r)},t.prototype.getStation=function(t,e,r,n){var a=this.createRequestUrl(e,"stations",t);return this.requestApi(a,r,n)},t.prototype.getTimeseries=function(n,t,e){var a=this,i=this.createRequestUrl(n,"timeseries");return new l.Observable(function(r){a.requestApiTexted(i,t,e).subscribe(function(t){var e=o.deserializeArray(V,t);e.forEach(function(t){t.url=n,a.internalDatasetId.generateInternalId(t)}),r.next(e)},function(t){return r.error(t)},function(){return r.complete()})})},t.prototype.getTimeseriesData=function(a,t,e,r){var i=this,o=this.createRequestUrl(a,"timeseries/getData");return new l.Observable(function(n){i.requestApiTextedPost(o,{timespan:i.createRequestTimespan(e),timeseries:t},r).subscribe(function(t){var e=[];for(var r in t)r&&e.push({id:r,url:a,data:t[r].values});n.next(e)},function(t){return n.error(t)},function(){return n.complete()})})},t.prototype.getSingleTimeseries=function(t,r,e){var n=this,a=this.createRequestUrl(r,"timeseries",t);return this.requestApiTexted(a,e).pipe(d.map(function(t){var e=o.deserialize(V,t);return e.url=r,n.internalDatasetId.generateInternalId(e),e}))},t.prototype.getSingleTimeseriesByInternalId=function(t,e){var r=this.internalDatasetId.resolveInternalId(t);return this.getSingleTimeseries(r.id,r.url,e)},t.prototype.getTimeseriesExtras=function(t,e){var r=this.createRequestUrl(e,"timeseries",t);return this.requestApi(r+"/extras")},t.prototype.getTsData=function(e,t,r,n,a){void 0===n&&(n={});var i=this.createRequestUrl(t,"timeseries",e)+"/getData";return n.timespan=this.createRequestTimespan(r),this.requestApi(i,n,a).pipe(d.map(function(t){return n.expanded&&(t=t[e]),t}))},t.prototype.getCategories=function(t,e,r){var n=this.createRequestUrl(t,"categories");return this.requestApi(n,e,r)},t.prototype.getCategory=function(t,e,r){throw new Error("Not implemented")},t.prototype.getPhenomena=function(t,e,r){var n=this.createRequestUrl(t,"phenomena");return this.requestApi(n,e,r)},t.prototype.getPhenomenon=function(t,e,r,n){var a=this.createRequestUrl(e,"phenomena",t);return this.requestApi(a,r,n)},t.prototype.getOfferings=function(t,e,r){var n=this.createRequestUrl(t,"offerings");return this.requestApi(n,e,r)},t.prototype.getOffering=function(t,e,r,n){var a=this.createRequestUrl(e,"offerings",t);return this.requestApi(a,r,n)},t.prototype.getFeatures=function(t,e,r){var n=this.createRequestUrl(t,"features");return this.requestApi(n,e,r)},t.prototype.getFeature=function(t,e,r,n){var a=this.createRequestUrl(e,"features",t);return this.requestApi(a,r,n)},t.prototype.getProcedures=function(t,e,r){var n=this.createRequestUrl(t,"procedures");return this.requestApi(n,e,r)},t.prototype.getProcedure=function(t,e,r,n){var a=this.createRequestUrl(e,"procedures",t);return this.requestApi(a,r,n)},t.prototype.getPlatforms=function(t,e,r){var n=this.createRequestUrl(t,"platforms");return this.requestApi(n,e,r)},t.prototype.getPlatform=function(t,e,r,n){var a=this.createRequestUrl(e,"platforms",t);return this.requestApi(a,r,n)},t.prototype.getDatasets=function(e,t,r){var n=this,a=this.createRequestUrl(e,"datasets");return this.requestApi(a,t,r).pipe(d.map(function(t){return t.map(function(t){return n.prepareDataset(t,e)})}))},t.prototype.getDataset=function(t,e,r,n){var a=this,i=this.createRequestUrl(e,"datasets",t);return this.requestApi(i,r,n).pipe(d.map(function(t){return a.prepareDataset(t,e)}))},t.prototype.getDatasetByInternalId=function(t,e,r){var n=this.internalDatasetId.resolveInternalId(t);return this.getDataset(n.id,n.url,e,r)},t.prototype.getData=function(t,e,r,n,a){void 0===n&&(n={});var i=this.createRequestUrl(e,"datasets",t)+"/data";return n.timespan=this.createRequestTimespan(r),this.requestApi(i,n,a)},t.prototype.requestApiTexted=function(t,e,r){return void 0===e&&(e={}),void 0===r&&(r={}),this.httpservice.client(r).get(t,{params:this.prepareParams(e),responseType:"text"})},t.prototype.requestApiTextedPost=function(t,e,r){return void 0===e&&(e={}),void 0===r&&(r={}),this.httpservice.client().post(t,e,{responseType:"json"})},t.prototype.prepareDataset=function(t,e){var r=o.deserialize(N,JSON.stringify(t));return r.url=e,this.internalDatasetId.generateInternalId(r),r.seriesParameters&&(r.parameters=r.seriesParameters,delete r.seriesParameters),r},t.decorators=[{type:s.Injectable}],t.ctorParameters=function(){return[{type:B},{type:m},{type:r.TranslateService}]},t}(U),Y=function(p){function t(t,e,r){var n=p.call(this,t,e,r)||this;return n.httpservice=t,n.internalDatasetId=e,n.translate=r,n}return D(t,p),t.prototype.getTsData=function(t,e,r,n,a){void 0===n&&(n={});var i=f.duration(1,"year").asMilliseconds();if(r.to-r.from>i){for(var o=[],s=f(r.from).startOf("year"),u=f(r.from).endOf("year");s.isBefore(f(r.to));){var c=new b(1e3*s.unix(),1e3*u.unix());o.push(p.prototype.getTsData.call(this,t,e,c,n,a)),s=u.add(1,"millisecond"),u=f(s).endOf("year")}return l.forkJoin(o).pipe(d.map(function(t){return t.reduce(function(t,e){var r={referenceValues:{},values:t.values.concat(e.values)};for(var n in t.referenceValues)t.referenceValues.hasOwnProperty(n)&&(r.referenceValues[n]=t.referenceValues[n].concat(e.referenceValues[n]));return r})}))}return p.prototype.getTsData.call(this,t,e,r,n,a)},t.decorators=[{type:s.Injectable}],t.ctorParameters=function(){return[{type:B},{type:m},{type:r.TranslateService}]},t}(F),W=function(t){var e=this;this.translate=t,this.translate.onLangChange.subscribe(function(){return e.languageChanged()})},z=function(){function t(t){this.translate=t}return t.prototype.ngOnChanges=function(t){t.languageList&&this.setCurrentLang()},t.prototype.setLanguage=function(t){this.translate.use(t.code),this.setCurrentLang()},t.prototype.setCurrentLang=function(){var e=this;this.currentLang=this.languageList.find(function(t){return t.code===e.translate.currentLang})},t.propDecorators={languageList:[{type:s.Input}]},t}(),J=function(){},K=function(){},G=function(){},X={measurement:0};X[X.measurement]="measurement";var $=function(){},Q=function(t,e){this.visible=!0,this.separateYAxis=!1,this.zeroBasedYAxis=!1,this.autoRangeSelection=!1,this.generalize=!1,this.showReferenceValues=[],this.pointRadius=0,this.lineWidth=1,this.internalId=t,this.color=e},Z=function(){},tt=function(a){function t(t,e,r){var n=a.call(this,t,e)||this;return n.timestamp=r,n}return D(t,a),t}(Q),et=function(){function t(){this.cache=new Map}return t.prototype.has=function(t){return this.cache.has(t)},t.prototype.get=function(t){return this.cache.get(t)},t.prototype.set=function(t,e){this.cache.set(t,e)},t}();var rt=function(){function t(){}return t.prototype.isContentLoading=function(t){this.onContentLoading.emit(t)},t}(),nt=function(){function t(){}return t.prototype.onWindowResize=function(t){this.onResize()},t.propDecorators={onWindowResize:[{type:s.HostListener,args:["window:resize",["$event"]]}]},t}(),at=require("deep-equal"),it=function(o){function t(t,e,r,n,a){var i=o.call(this)||this;return i.iterableDiffers=t,i.api=e,i.datasetIdResolver=r,i.timeSrvc=n,i.translateService=a,i.datasetIds=[],i.selectedDatasetIds=[],i.onDatasetSelected=new s.EventEmitter,i.onTimespanChanged=new s.EventEmitter,i.onMessageThrown=new s.EventEmitter,i.onContentLoading=new s.EventEmitter,i.datasetIdsDiffer=i.iterableDiffers.find([]).create(),i.selectedDatasetIdsDiffer=i.iterableDiffers.find([]).create(),i.langChangeSubscription=i.translateService.onLangChange.subscribe(function(t){return i.onLanguageChanged(t)}),i}return D(t,o),t.prototype.ngOnChanges=function(t){t.timeInterval&&this.timeInterval&&(this.timespan=this.timeSrvc.createTimespanOfInterval(this.timeInterval),this.timeIntervalChanges()),t.reloadForDatasets&&this.reloadForDatasets&&0<this.reloadDataForDatasets.length&&this.reloadDataForDatasets(this.reloadForDatasets)},t.prototype.ngOnDestroy=function(){this.langChangeSubscription.unsubscribe()},t.prototype.ngDoCheck=function(){var r=this,t=this.datasetIdsDiffer.diff(this.datasetIds);t&&(t.forEachAddedItem(function(t){r.addDatasetByInternalId(t.item)}),t.forEachRemovedItem(function(t){r.removeDataset(t.item)}));var e=this.selectedDatasetIdsDiffer.diff(this.selectedDatasetIds);if(e&&(e.forEachAddedItem(function(t){r.setSelectedId(t.item)}),e.forEachRemovedItem(function(t){r.removeSelectedId(t.item)})),!at(this.oldPresenterOptions,this.presenterOptions)){this.oldPresenterOptions=Object.assign({},this.presenterOptions);var n=Object.assign({},this.presenterOptions);this.presenterOptionsChanged(n)}if(this.datasetOptions){var a=this.oldDatasetOptions===undefined;a&&(this.oldDatasetOptions=new Map),this.datasetOptions.forEach(function(t,e){at(t,r.oldDatasetOptions.get(e))||(r.oldDatasetOptions.set(e,Object.assign({},r.datasetOptions.get(e))),r.datasetOptionsChanged(e,t,a))})}},t.prototype.addDatasetByInternalId=function(t){var e=this.datasetIdResolver.resolveInternalId(t);this.addDataset(e.id,e.url)},t.propDecorators={datasetIds:[{type:s.Input}],selectedDatasetIds:[{type:s.Input}],timeInterval:[{type:s.Input}],datasetOptions:[{type:s.Input}],presenterOptions:[{type:s.Input}],reloadForDatasets:[{type:s.Input}],onDatasetSelected:[{type:s.Output}],onTimespanChanged:[{type:s.Output}],onMessageThrown:[{type:s.Output}],onContentLoading:[{type:s.Output}]},t}(nt),ot={ERROR:0,INFO:1};ot[ot.ERROR]="ERROR",ot[ot.INFO]="INFO";var st=function(){function t(){this.settings={}}return t.prototype.getSettings=function(){return this.settings},t.prototype.setSettings=function(t){this.settings=t},t}(),ut=function(){function t(t){this.httpClient=t,this.urls=[]}return t.prototype.checkAll=function(){return this.doCheck(this.urls)},t.prototype.checkUrl=function(t){return this.doCheckUrl(t)},t.prototype.checkUrls=function(t){return this.doCheck(t)},t.prototype.addUrl=function(t){-1===this.urls.indexOf(t)&&this.urls.push(t)},t.prototype.removeUrl=function(t){var e=this.urls.indexOf(t);-1<e&&this.urls.splice(e,1)},t.prototype.doCheckUrl=function(r){var t=this;return new l.Observable(function(e){t.httpClient.get(r).subscribe(function(t){e.next(null),e.complete()},function(t){e.next(r),e.complete()})})},t.prototype.doCheck=function(t){var e=this,r=[];return t.forEach(function(t){return r.push(e.doCheckUrl(t))}),l.forkJoin(r).pipe(d.map(function(t){return t.filter(function(t){if(t)return t})}))},t.decorators=[{type:s.Injectable}],t.ctorParameters=function(){return[{type:a.HttpClient}]},t}();t.DatasetApiInterface=U,t.UriParameterCoder=P,t.DatasetApiMapping=p,t.DatasetApiVersion=c,t.SplittedDataDatasetApiInterface=Y,t.DatasetImplApiInterface=F,t.InternalIdHandler=m,t.HTTP_SERVICE_INTERCEPTORS=k,t.HttpService=B,t.LanguageChangNotifier=W,t.LocalSelectorComponent=z,t.HelgolandCoreModule=E,t.ApiInterface=q,t.DatasetService=w,t.RenderingHintsDatasetService=C,t.ColorService=u,t.StatusIntervalResolverService=h,t.LocalStorage=y,t.ReferenceValues=J,t.ParameterConstellation=H,t.FirstLastValue=_,t.ReferenceValue=L,t.DatasetParameterConstellation=j,t.Dataset=N,t.Timeseries=V,t.TimeseriesData=M,t.Station=K,t.TimeseriesCollection=G,t.PlatformTypes={stationary:"stationary",mobile:"mobile",mobileInsitu:"mobile_insitu"},t.ValueTypes={quantity:"quantity",quantityProfile:"quantity-profile"},t.DatasetTypes=X,t.Filter=$,t.TimeInterval=T,t.Timespan=b,t.BufferedTime=R,t.DatasetOptions=Q,t.ReferenceValueOption=Z,t.TimedDatasetOptions=tt,t.IdCache=et,t.Mixin=function(t){return function(r){t.forEach(function(e){Object.getOwnPropertyNames(e.prototype).forEach(function(t){r.prototype[t]=e.prototype[t]})})}},t.HasLoadableContent=rt,t.NotifierService=v,t.DateProxyPipe=I,t.DatasetPresenterComponent=it,t.PresenterMessageType=ot,t.SettingsService=st,t.StatusCheckService=ut,t.DefinedTimespan=S,t.DefinedTimespanService=x,t.Time=A,t.ɵa=nt,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=helgoland-core.umd.min.js.map