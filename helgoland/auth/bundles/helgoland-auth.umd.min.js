!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common/http"),require("@angular/core"),require("rxjs/operators"),require("@helgoland/core"),require("rxjs")):"function"==typeof define&&define.amd?define("@helgoland/auth",["exports","@angular/common/http","@angular/core","rxjs/operators","@helgoland/core","rxjs"],t):t((e.helgoland=e.helgoland||{},e.helgoland.auth={}),e.ng.common.http,e.ng.core,e.rxjs.operators,null,e.rxjs)}(this,function(e,c,t,o,r,a){"use strict";var n=function(){function e(e){this.http=e,this.basicAuthTokens=new Map}return e.prototype.auth=function(e,t,r){var n=this,i="Basic "+btoa(e+":"+t),s=new c.HttpHeaders({Authorization:i});return this.http.get(r,{headers:s}).pipe(o.map(function(e){return n.basicAuthTokens.set(r,i),i}))},e.prototype.clearToken=function(e){this.basicAuthTokens.has(e)&&this.basicAuthTokens["delete"](e)},e.prototype.hasToken=function(e){return this.basicAuthTokens.has(e)},e.prototype.getToken=function(e){return this.basicAuthTokens.has(e)?this.basicAuthTokens.get(e):null},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:c.HttpClient}]},e}(),i=function(){function e(e){this.settingsService=e,this.services=[]}return e.prototype.registerService=function(e){-1===this.services.indexOf(e)&&this.services.push(e)},e.prototype.getCorrespondingService=function(t){var e=this.services.find(function(e){return t.startsWith(e)});if(e)return e;var r=this.settingsService.getSettings();if(r&&r.datasetApis&&Array.isArray(r.datasetApis)){var n=r.datasetApis.find(function(e){return t.startsWith(e.url)&&e.basicAuth});if(n)return n.url}},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:r.SettingsService}]},e}(),s=function(){function e(e,t,r,n){this.settings=e,this.basicAuthServices=t,this.basicAuthSrvc=r,this.receptor=n}return e.prototype.intercept=function(r,n,i){var s=this,o=this.basicAuthServices.getCorrespondingService(r.url);return o?this.basicAuthSrvc.hasToken(o)?(r=r.clone({setHeaders:{Authorization:this.basicAuthSrvc.getToken(o)}}),i.handle(r,n)):new a.Observable(function(t){s.receptor.doBasicAuth(o).subscribe(function(e){e&&(r=r.clone({setHeaders:{Authorization:s.basicAuthSrvc.getToken(o)}})),i.handle(r,n).subscribe(function(e){t.next(e),e instanceof c.HttpResponse&&t.complete()})})}):i.handle(r,n)},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:r.SettingsService},{type:i},{type:n},{type:u}]},e}(),u=function(){},h=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{providers:[n,i,{provide:r.HTTP_SERVICE_INTERCEPTORS,useClass:s,multi:!0}]}]}],e}();e.BasicAuthService=n,e.BasicAuthServiceMaintainer=i,e.HelgolandBasicAuthModule=h,e.BasicAuthInterceptorService=s,e.BasicAuthInformer=u,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=helgoland-auth.umd.min.js.map