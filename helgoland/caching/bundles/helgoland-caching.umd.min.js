!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/common/http"),require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@helgoland/core")):"function"==typeof define&&define.amd?define("@helgoland/caching",["exports","@angular/common/http","@angular/core","rxjs","rxjs/operators","@helgoland/core"],t):t((e.helgoland=e.helgoland||{},e.helgoland.caching={}),e.ng.common.http,e.ng.core,e.rxjs,e.rxjs.operators,null)}(this,function(e,c,r,t,a,n){"use strict";var o=function(){},i=function(){},s=function(){function e(e,t){this.cache=e,this.ongoingCache=t}return e.prototype.intercept=function(r,n,o){var i=this;if("GET"!==r.method)return o.handle(r,n);if(n.forceUpdate)return o.handle(r,n);var e=this.cache.get(r,n.expirationAtMs);return e?t.of(e):this.ongoingCache.has(r)?this.ongoingCache.observe(r):new t.Observable(function(t){var e=o.handle(r,n).pipe(a.share());e.subscribe(function(e){e instanceof c.HttpResponse&&(i.cache.put(r,e,n.expirationAtMs),i.ongoingCache.clear(r),t.next(e),t.complete())},function(e){t.error(e),t.complete()}),i.ongoingCache.set(r,e)})},e.decorators=[{type:r.Injectable}],e.ctorParameters=function(){return[{type:o},{type:i}]},e}(),u=function(e,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cache={},e}return function(e,t){function r(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}(e,t),e.prototype.get=function(e,t){var r=e.urlWithParams;if(this.cache[r]){var n=(new Date).getTime();if(isNaN(this.cache[r].expirationAtMs))return this.cache[r].expirationAtMs=t,this.cache[r].response;if(this.cache[r].expirationAtMs>=n)return this.cache[r].expirationAtMs>t&&(this.cache[r].expirationAtMs=t),this.cache[r].response;delete this.cache[r]}return null},e.prototype.put=function(e,t,r){this.cache[e.urlWithParams]={expirationAtMs:r||(new Date).getTime()+3e4,response:t}},e.decorators=[{type:r.Injectable}],e}(o),p=function(){function e(){this.cache={}}return e.prototype.has=function(e){return this.cache[e.urlWithParams]!==undefined},e.prototype.set=function(e,t){this.cache[e.urlWithParams]={request:t}},e.prototype.observe=function(e){return this.cache[e.urlWithParams].request},e.prototype.clear=function(e){delete this.cache[e.urlWithParams]},e.decorators=[{type:r.Injectable}],e}(),l=function(){function e(){}return e.decorators=[{type:r.NgModule,args:[{declarations:[],imports:[],exports:[],providers:[{provide:o,useClass:h},{provide:n.HTTP_SERVICE_INTERCEPTORS,useClass:s,multi:!0},{provide:i,useClass:p}]}]}],e}();e.HelgolandCachingModule=l,e.CachingInterceptor=s,e.LocalHttpCache=h,e.LocalOngoingHttpCache=p,e.HttpCache=o,e.OnGoingHttpCache=i,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=helgoland-caching.umd.min.js.map