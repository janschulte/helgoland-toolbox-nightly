!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@helgoland/core"),require("@ngx-translate/core"),require("rxjs/Observable"),require("@angular/common")):"function"==typeof define&&define.amd?define("@helgoland/favorite",["exports","@angular/core","@helgoland/core","@ngx-translate/core","rxjs/Observable","@angular/common"],e):e((t.helgoland=t.helgoland||{},t.helgoland.favorite={}),t.ng.core,null,null,t.rxjs.Observable,t.ng.common)}(this,function(t,e,r,o,i,a){"use strict";var s="SingleFavorites",n="GroupFavorites",v=function(){function t(t){this.localStorage=t,this.groupCounter=0,this.loadFavorites()}return t.prototype.addFavorite=function(t,e){return!this.singleFavs.has(t.internalId)&&(this.singleFavs.set(t.internalId,{id:t.internalId,label:e||t.label,favorite:t}),this.saveFavorites(),!0)},t.prototype.hasFavorite=function(t){return this.singleFavs.has(t.internalId)},t.prototype.getFavorites=function(){return Array.from(this.singleFavs.values())},t.prototype.removeFavorite=function(t){return this.singleFavs.has(t)?(this.singleFavs["delete"](t),this.saveFavorites(),!0):!!this.groupFavs.has(t)&&(this.groupFavs["delete"](t),this.saveFavorites(),!0)},t.prototype.addFavoriteGroup=function(t,e){var r="Group"+this.groupCounter++;return this.groupFavs.set(r,{id:r,label:e||r,favorites:t}),this.saveFavorites(),!0},t.prototype.getFavoriteGroups=function(){return Array.from(this.groupFavs.values())},t.prototype.removeAllFavorites=function(){return this.singleFavs.clear(),this.groupFavs.clear(),this.saveFavorites(),!0},t.prototype.changeLabel=function(t,e){t.label=e,"favorite"in t&&this.singleFavs.set(t.id,t),"favorites"in t&&this.groupFavs.set(t.id,t),this.saveFavorites()},t.prototype.saveFavorites=function(){this.localStorage.save(s,this.getFavorites()),this.localStorage.save(n,this.getFavoriteGroups())},t.prototype.loadFavorites=function(){var e=this;this.singleFavs=new Map,this.groupFavs=new Map;var t=this.localStorage.loadArray(s);t&&t.forEach(function(t){return e.singleFavs.set(t.id,t)});var r=this.localStorage.loadArray(n);r&&r.forEach(function(t){return e.groupFavs.set(t.id,t)})},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:r.LocalStorage}]},t}();var l=function(){function t(t,e,r){this.favSrvc=t,this.notifier=e,this.translate=r}return t.prototype.ngOnChanges=function(t){t.dataset&&this.dataset&&(this.isFavorite=this.favSrvc.hasFavorite(this.dataset))},t.prototype.toggle=function(){var e=this;this.isFavorite?(this.isFavorite=!1,this.favSrvc.removeFavorite(this.dataset.internalId),this.translate.get("favorite.notifier.remove-favorite").subscribe(function(t){e.notifier.notify(t+": "+e.dataset.label)})):(this.isFavorite=!0,this.favSrvc.addFavorite(this.dataset),this.translate.get("favorite.notifier.add-favorite").subscribe(function(t){e.notifier.notify(t+": "+e.dataset.label)}))},t.decorators=[{type:e.Component,args:[{selector:"n52-favorite-toggler",template:'<i class="fa" (click)="toggle(); $event.stopPropagation();" [ngClass]="isFavorite ? \'fa-star\' : \'fa-star-o\'"></i>'}]}],t.ctorParameters=function(){return[{type:v},{type:r.NotifierService},{type:o.TranslateService}]},t.propDecorators={dataset:[{type:e.Input}]},t}(),c=function(){function t(t){this.favoriteSrvc=t}return t.prototype.exportFavorites=function(){var t=JSON.stringify(this.favoriteSrvc.getFavorites()),e=document.createElement("a");e.href="data:application/json,"+encodeURIComponent(t),e.target="_blank",e.download="favorites.json",document.body.appendChild(e),e.click()},t.prototype.importFavorites=function(o){var a=this;return new i.Observable(function(r){var t=o.target.files;if(t&&0<t.length){a.favoriteSrvc.removeAllFavorites();var e=new FileReader;e.readAsText(t[0]),e.onerror=function(){},e.onload=function(t){var e=t.target.result;JSON.parse(e).forEach(function(t){a.favoriteSrvc.addFavorite(t.favorite,t.label)}),r.next(!0),r.complete()}}})},t.decorators=[{type:e.Injectable}],t.ctorParameters=function(){return[{type:v}]},t}(),u=[l],f=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:[u],imports:[a.CommonModule],exports:[u],providers:[v,c]}]}],t}();t.HelgolandFavoriteModule=f,t.FavoriteService=v,t.JsonFavoriteExporterService=c,t.Éµa=l,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=helgoland-favorite.umd.min.js.map